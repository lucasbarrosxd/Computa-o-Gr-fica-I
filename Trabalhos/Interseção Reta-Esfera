InterseÃ§Ã£o reta-esfera

Dados uma reta R = (Pr, v) e uma esfera E = (Po, r), calcular a interseÃ§Ã£o entre os dois.

SOLUÃ‡ÃƒO:

Queremos encontrar um ponto que esteja contido tanto na reta R quanto na esfera E. Logo temos:

(1) P = Pr + t * v     // EquaÃ§Ã£o da reta.
(2) ||PPo|| = r        // DistÃ¢ncia entre a interseÃ§Ã£o e o centro da esfera Ã© igual ao raio.

Podemos desenvolver (2):

(2) ||PPo|| = r
2.1 sqrt(PPo â€¢ PPo) = r     // NÃ£o introduzimos 'â¬Œ PPc â€¢ PPc â‰¥ 0' pois para qualquer vetor x, x â€¢ x â‰¥ 0.
2.2 PPo â€¢ PPo = rÂ²
2.3 (Po - P) â€¢ (Po - P) = rÂ²
2.4 (Po - (Pr + t * v)) â€¢ (Po - (Pr + t * v)) = rÂ²
2.5 (Po - Pr - t * v) â€¢ (Po - Pr - t * v) = rÂ²
2.6 ((Po - Pr) - t * v) â€¢ ((Po - Pr) - t * v) = rÂ²
2.7 (PrPo - t * v) â€¢ (PrPo - t * v) = rÂ²
2.8 PrPo â€¢ PrPo - 2t * PrPo â€¢ v + tÂ² * v â€¢ v = rÂ²
2.9 tÂ² * (v â€¢ v) + t * (- 2 * PrPo â€¢ v) + (PrPo â€¢ PrPo - rÂ²) = 0

Solucionando a equaÃ§Ã£o de 2Âº grau em t:

2.A t = ((- b) Â± sqrt(Î”)) / (2 * a)                                                            â¬Œ a â‰  0, Î” â‰¥ 0
2.B t = (2 * PrPo â€¢ v Â± sqrt(4 * PrPo â€¢ v - 4 * v â€¢ v * (PrPo â€¢ PrPo - rÂ²))) / (2 * v â€¢ v)     â¬Œ a â‰  0, Î” â‰¥ 0
2.C t = (PrPo â€¢ v Â± sqrt(PrPo â€¢ v - v â€¢ v * (PrPo â€¢ PrPo - rÂ²))) / (v â€¢ v)                     â¬Œ a â‰  0, Î” â‰¥ 0
    
Encontramos uma fÃ³rmula para t, mas ainda Ã© necessÃ¡rio verificar os casos em que essa fÃ³rmula nÃ£o Ã© vÃ¡lida:

a = 0:
(3) a = v â€¢ v = 0
3.1 ðŸ š v = 0
3.2 ðŸ š x â€¢ v = 0 para qualquer vetor x

2.9 tÂ² * (v â€¢ v) + t * (- 2 * PrPo â€¢ v) + (PrPo â€¢ PrPo - rÂ²) = 0     // Antes de introduzirmos 'â¬Œ v â‰  0'.
2.D tÂ² * 0 + t * (- 2 * 0) + (PrPo â€¢ PrPo - rÂ²) = 0
2.E PrPo â€¢ PrPo - rÂ² = 0
2.F PrPo â€¢ PrPo = rÂ²
    
Quando essa equaÃ§Ã£o Ã© verdade, qualquer valor de t Ã© soluÃ§Ã£o. Caso contrÃ¡rio, nenhum valor de t Ã© soluÃ§Ã£o.

O caso Î” < 0 caso Ã© especial. Sempre que o delta Ã© menor que zero, nÃ£o hÃ¡ soluÃ§Ã£o nos reais pois ambas as raÃ­zes sÃ£o
complexas. Note que nÃ£o hÃ¡ como os dois casos acontecerem, pois Î” = bÂ² - 4 * a * c, e se a = 0 entÃ£o Î” = bÂ² â‰¥ 0.
